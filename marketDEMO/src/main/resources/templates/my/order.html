<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>마이페이지::전체주문내역</title>
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <link rel="stylesheet" href="/css/my/myPage.css">
    <script src="/js/periodFilter.js"></script>
    <style>
        .sidebar nav a:nth-child(1) {
            text-decoration: underline;
        }
    </style>
</head>
<body>
<!-- ■■■■■ 헤더 ■■■■■ -->
<div class="header-wrap" th:replace="~{my/_header.html}"></div>
<!-- □□□□□ 헤더 □□□□□ -->
<!-- 마이페이지 요약 정보 -->
<!-- DB연결 예정 for each -->
<div style="width: 100%;  background-color: #f2f2f2; display: flex; flex-direction: column; position: sticky; top: 0; height: 100px;max-width: 1920px;
            margin: 0 auto;">
    <div class="summary" style="display: inline-flex; min-width: 1060px; margin: 0 auto; width: 100%;">
        <div style="margin-left: 5%; margin-right: auto; display: flex; align-items: center; height: 100px;">
            <span style="font-size: 24px; font-weight: bold;">나의쇼핑정보</span>
        </div>
        <div style="width: 25%; margin-right: 5%; display: flex; align-items: center;">
            <table style="border-collapse: collapse; text-align: center; width: 100%; height: 70%;">
                <colgroup>
                    <col style="width: 25%;">
                    <col style="width: 25%;">
                    <col style="width: 25%;">
                    <col style="width: 25%;">
                </colgroup>
                <tr>
                    <th style="border-right: solid 1px #d9d9d9;">주문</th>
                    <th style="border-right: solid 1px #d9d9d9;">쿠폰</th>
                    <th style="border-right: solid 1px #d9d9d9;">포인트</th>
                    <th>문의</th>
                </tr>
                <tr>
                    <td style="border-right: solid 1px #d9d9d9;">[[${userOrderCount}]]</td>
                    <td style="border-right: solid 1px #d9d9d9;">[[${userCouponCount}]]</td>
                    <td style="border-right: solid 1px #d9d9d9;"><span th:text="${#numbers.formatInteger(userPoints, 3, 'COMMA')}"></span></td>
                    <td>[[${userQnaCount}]]</td>
                </tr>
            </table>
        </div>
    </div>
    <!-- ■■■■■ 사이드바 ■■■■■ -->
    <div th:replace="~{my/_sidebar.html}"></div>
    <!-- □□□□□ 사이드바 □□□□□ -->
</div>
<main class="mincheolkang" style="display: flex; flex-wrap: nowrap;">
    <!-- ■■■■■ 사이드바 공간 ■■■■■ -->
    <div style="width: 25%; height: 1px; min-width: 240px;"></div>
    <!-- □□□□□ 사이드바 공간 □□□□□ -->
    <section class="main-content" style="margin-left: 10px;">
        <div class="ad-banner" style="width: 100%; height: 86px; text-align: center;">
            <img src="/images/adv.png" style="width: 810px; height: 100%;">
        </div>
        <article>
            <h3>전체주문내역</h3>
            <form th:action="@{/my/order}" method="get" class="search-period">
                <span>기간별조회</span>

                <!-- 단위 버튼 (radio) -->
                <label><input type="radio" name="unit" value="1w"> 1주일</label>
                <label><input type="radio" name="unit" value="15d"> 15일</label>
                <label><input type="radio" name="unit" value="1m"> 1개월</label>

                <!-- 최근 5개월 -->
                <select name="recentMonths">
                    <option value="">-- 최근 5개월 중 선택 --</option>
                </select>

                <!-- 시작일 ~ 종료일 -->
                <input type="date" name="startDate"> ~
                <input type="date" name="endDate">

                <button type="submit">조회</button>
            </form>
            <!-- 전체주문내역 -->
            <table class="orderList myPageTable">
                <tr>
                    <th>날짜</th>
                    <th colspan="2">상품정보</th>
                    <th>상태</th>
                    <th>확인/신청</th>
                </tr>
                <tr th:each="order : ${pageResponseDTO.poDtoList}" th:object="${order}">
                    <td>[[*{poOrderdate}]]</td>
                    <td><img src="/images/로고.png"/></td>
                    <td>
                        <a href="#" class="orderNum" th:attr="order=*{poNo}">주문번호 : [[*{poNo}]]</a><br>
                        <a href="#" class="tradeName">[[*{sCompanyName}]]</a><br>
                        <a href="#">[[*{pName}]]</a><br>
                        수량 : [[*{oiProdQty}]]개<br>
                        <b><span th:text="${#numbers.formatInteger(order.oiTotPrice, 3, 'COMMA')} + '원'">totPrice</span></b>
                    </td>
                    <td th:if="*{poState} != '구매확정'" th:attr="name='state', order=*{poNo}">[[*{oiDelStatus}]]</td>
                    <td th:if="*{poState} == '구매확정'" style="color: blue; font-weight: bold;">[[*{poState}]]</td>
                    <td>
                        <button name="buyConfirm" class="blueButton" th:attr="order=*{poNo}"
                        th:if="*{oiDelStatus} == '배송완료' and *{poState} != '구매확정'">구매확정</button><br th:if="*{oiDelStatus} == '배송완료' and *{poState} != '구매확정'">
                        <button name="productReview" class="blueButton">상품평쓰기</button><br>
                        <button name="returnRequest">반품신청</button><br>
                        <button name="exchangeRequest">교환신청</button>
                    </td>
                </tr>
            </table>
            <div class="Pagenation" style="text-align: center;">
                <a th:if="${pageResponseDTO.prev}" th:href="@{/my/order(pg=${pageResponseDTO.start - 1},
                unit=${pageResponseDTO.unit}?${pageResponseDTO.unit}:null,
                recentMonths=${pageResponseDTO.recentMonths}?${pageResponseDTO.recentMonths}:null,
                startDate=${pageResponseDTO.startDate}?${pageResponseDTO.startDate}:null,
                endDate=${pageResponseDTO.endDate}?${pageResponseDTO.endDate}:null)}">이전</a>
                &nbsp;&nbsp;
                <th:block th:each="num:${#numbers.sequence(pageResponseDTO.start, pageResponseDTO.end)}">
                    <a th:href="@{/my/order(pg=${num},
                    unit=${pageResponseDTO.unit}?${pageResponseDTO.unit}:null,
                    recentMonths=${pageResponseDTO.recentMonths}?${pageResponseDTO.recentMonths}:null,
                    startDate=${pageResponseDTO.startDate}?${pageResponseDTO.startDate}:null,
                    endDate=${pageResponseDTO.endDate}?${pageResponseDTO.endDate}:null)}" th:class="${num == pageResponseDTO.pg ? 'current' : 'num'}">[[${num}]]</a>
                </th:block>
                &nbsp;&nbsp;
                <a th:if="${pageResponseDTO.next}" th:href="@{/my/order(pg=${pageResponseDTO.end + 1},
                    recentMonths=${pageResponseDTO.recentMonths}?${pageResponseDTO.recentMonths}:null,
                    startDate=${pageResponseDTO.startDate}?${pageResponseDTO.startDate}:null,
                    endDate=${pageResponseDTO.endDate}?${pageResponseDTO.endDate}:null)}">다음</a>
            </div>
        </article>
    </section>
    <!-- ■■■■■ 주문상세 팝업 ■■■■■ -->
    <article th:replace="~{my/modal/orderDetails.html}"></article>
    <!-- □□□□□ 주문상세 팝업 □□□□□ -->
    <!-- ■■■■■ 판매자정보 팝업 ■■■■■ -->
    <article th:replace="~{my/modal/sellerInfo.html}"></article>
    <!-- □□□□□ 판매자정보 팝업 □□□□□ -->
    <!-- ■■■■■ 문의하기 팝업 ■■■■■ -->
    <article th:replace="~{my/modal/sellerInquire.html}"></article>
    <!-- □□□□□ 문의하기 팝업 □□□□□ -->
    <!-- ■■■■■ 구매확정 팝업 ■■■■■ -->
    <article th:replace="~{my/modal/buyConfirm.html}"></article>
    <!-- □□□□□ 구매확정 팝업 □□□□□ -->
    <!-- ■■■■■ 상품평작성하기 팝업 ■■■■■ -->
    <article th:replace="~{my/modal/productReview.html}"></article>
    <!-- □□□□□ 상품평작성하기 팝업 □□□□□ -->
    <!-- ■■■■■ 반품신청 팝업 ■■■■■ -->
    <article th:replace="~{my/modal/returnRequest.html}"></article>
    <!-- □□□□□ 반품신청 팝업 □□□□□ -->
    <!-- ■■■■■ 교환신청 팝업 ■■■■■ -->
    <article th:replace="~{my/modal/exchangeRequest.html}"></article>
    <!-- □□□□□ 교환신청 팝업 □□□□□ -->
</main>

<!-- ■■■■■ 푸터 ■■■■■ -->
<div th:replace="~{my/_footer.html}"></div>
<!-- □□□□□ 푸터 □□□□□ -->



<!-- <%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%> -->

<!--강민철 2025-10-21 1029-->


